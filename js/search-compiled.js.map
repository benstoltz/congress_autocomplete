{"version":3,"sources":["search.js"],"names":[],"mappings":";;;;;;AAIA,MAAM,CAAC,MAAM,GAAG,YAAY;;AAExB,QAAI,UAAU,GAAG,EAAE,CAAC,UAAU,CAAC;;AAE/B,QAAI,OAAO,GAAG,QAAQ,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;AACjD,QAAI,OAAO,GAAG,QAAQ,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;AACjD,QAAI,YAAY,GAAG,QAAQ,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC;;AAG3D,QAAI,UAAU,GAAG,UAAU,CAAC,SAAS,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC;AAC3D,QAAI,kBAAkB,GAAG,UAAU,CAAC,SAAS,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;;AAErE,QAAI,WAAW,GAAG,EAAE,CAAC;;AAGrB,QAAI,cAAc,GAAG,SAAjB,cAAc,CAAG,IAAI;eACrB,UAAU,CAAC,MAAM,CAAC,SAAS,OAAO,CAAC,UAAU,EAAE;AAC3C,gBAAI,SAAS,GAAG,KAAK,CAAC;AACtB,gBAAI,GAAG,GAAG,4GAA4G,GAAG,kBAAkB,CAAC,IAAI,CAAC,CAAC;AAClJ,aAAC,CAAC,OAAO,CAAC,GAAG,EAAE,UAAA,IAAI,EAAI;AACnB,oBAAI,CAAC,SAAS,EAAE;AACZ,8BAAU,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;AAChC,8BAAU,CAAC,WAAW,EAAE,CAAC;iBAC5B;aACJ,CAAC,CAAC;;AAEH,mBAAO,SAAS,OAAO,GAAG;AACtB,yBAAS,GAAG,IAAI,CAAC;aACpB,CAAA;SACJ,CAAC;KAAA,CAAC;;AAEP,QAAI,eAAe,GAAG,kBAAkB,CAAC,QAAQ,CAAC,SAAS,MAAM,CAAC,CAAC,EAAE;AACjE,gBAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;KACjE,CAAE,CAAC;;AAEJ,QAAI,gBAAgB,GAAG,eAAe,CAAC,GAAG,CAAE,YAAM;AAC9C,YAAI,WAAW,GAAG,UAAU,CAAC,SAAS,CAAC,QAAQ,CAAC,cAAc,CAAC,aAAa,CAAC,EAAE,OAAO,CAAC,CAAC;AACxF,YAAI,gBAAgB,GAAG,WAAW,CAAC,QAAQ,CAAE;mBACzC,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM;SAAA,CAC/D,CAAC;;AAEF,eAAO,UAAU,CAAC,QAAQ,CAAC,EAAE,CAAC,CAC1B,GAAG,CAAE,UAAC,GAAG;mBAAK,OAAO,CAAC,KAAK;SAAA,CAAE,CAC7B,oBAAoB,EAAE,CACtB,GAAG,CAAE,UAAA,MAAM;mBACP,cAAc,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;SAAA,CAClC,CAAC,YAAY,EAAE,CAChB,SAAS,CAAC,gBAAgB,CAAC,CAAA;KAElC,CAAC,CAAC,YAAY,EAAE,CAAC;;;;;;;;;;AAUlB,oBAAgB,CAAC,OAAO,CAAE,UAAC,SAAS,EAAK;AACrC,iBAAS,CAAC,OAAO,CAAE,UAAC,MAAM,EAAK;AAC3B,mBAAO,CAAC,KAAK,IAAI,MAAM,CAAC,UAAU,GAAG,GAAG,GAAG,MAAM,CAAC,SAAS,GAAG,IAAI,CAAC;SACtE,CAAC,CAAA;KACL,CAAC,CAAC;;;;;;;;;;;CAaN,CAAC","file":"search-compiled.js","sourcesContent":["/**\r\n * Created by ben7664 on 9/30/2015.\r\n */\r\n\r\nwindow.onload = function () {\r\n\r\n    let Observable = Rx.Observable;\r\n\r\n    let textbox = document.getElementById('textbox');\r\n    let results = document.getElementById('results');\r\n    let searchButton = document.getElementById('searchButton');\r\n\r\n\r\n    let keypresses = Observable.fromEvent(textbox, 'keypress');\r\n    let searchButtonClicks = Observable.fromEvent(searchButton, 'click');\r\n\r\n    let resultArray = [];\r\n\r\n\r\n    let getCongressman = term =>\r\n        Observable.create(function forEach(observable) {\r\n            let cancelled = false;\r\n            let url = \"http://congress.api.sunlightfoundation.com/legislators/locate?apikey=9f64292279cc4c40aea72946979597a2&zip=\" + encodeURIComponent(term);\r\n            $.getJSON(url, data => {\r\n                if (!cancelled) {\r\n                    observable.onNext(data.results);\r\n                    observable.onCompleted();\r\n                }\r\n            });\r\n\r\n            return function dispose() {\r\n                cancelled = true;\r\n            }\r\n        });\r\n\r\n    let searchFormOpens = searchButtonClicks.doAction(function onNext(v) {\r\n        document.getElementById('searchForm').style.display = \"block\";\r\n    } );\r\n\r\n    let searchResultSets = searchFormOpens.map( () => {\r\n        let closeClicks = Observable.fromEvent(document.getElementById(\"closeButton\"), 'click');\r\n        let searchFormCloses = closeClicks.doAction( () =>\r\n            document.getElementById('searchForm').style.display = \"none\"\r\n        );\r\n\r\n        return keypresses.throttle(20).\r\n            map( (key) => textbox.value ).\r\n            distinctUntilChanged().\r\n            map( search =>\r\n                getCongressman(search).retry(3)\r\n            ).switchLatest().\r\n            takeUntil(searchFormCloses)\r\n\r\n    }).switchLatest();\r\n\r\n    //\r\n    //searchResultSets.forEach( (resultSet) => {\r\n    //    console.log(resultSet);\r\n    //    let names = resultSet.forEach( result => result.last_name);\r\n    //\r\n    //    return results.value = names\r\n    //\r\n    //});\r\n    searchResultSets.forEach( (resultSet) => {\r\n        resultSet.forEach( (result) => {\r\n            results.value += result.first_name + \" \" + result.last_name + \"\\n\";\r\n        })\r\n    });\r\n\r\n    //getCongressman('Leahy').forEach( (results) =>\r\n    //        console.log(results)\r\n    //);\r\n    //\r\n    //getCongressman('Leahy').forEach( (results) =>\r\n    //        results.forEach( (result) =>\r\n    //                console.log(result.last_name)\r\n    //        )\r\n    //)\r\n\r\n\r\n};\r\n\r\n\r\n//window.onload = function() {\r\n//\r\n//    var Observable = Rx.Observable;\r\n//\r\n//    var textbox = document.getElementById('textbox');\r\n//\r\n//    var results = document.getElementById('results');\r\n//\r\n//    var keypresses = Observable.fromEvent(textbox,     'keypress');\r\n//\r\n//    var searchButton = document.getElementById('searchButton');\r\n//    var searchButtonClicks = Observable.fromEvent(searchButton, 'click');\r\n//\r\n//// keypresses.forEach(e => console.log(e.keyCode));\r\n//\r\n//\r\n//    function getWikipediaSearchResults(term) {\r\n//        return Observable.create(function forEach(observable) {\r\n//            var cancelled = false;\r\n//\r\n//            var url = \"http://en.wikipedia.org/w/api.php?action=opensearch&format=json&search=\" + encodeURIComponent(term) + '&callback=?';\r\n//\r\n//            $.getJSON(url, function(data){\r\n//                if (!cancelled) {\r\n//                    observable.onNext(data[1]);\r\n//                    observable.onCompleted();\r\n//                }\r\n//            });\r\n//\r\n//            return function dispose() {\r\n//                cancelled = true;\r\n//            };\r\n//        });\r\n//    }\r\n//\r\n//    var searchFormOpens = searchButtonClicks.doAction(\r\n//        function onNext(v) {\r\n//            document.getElementById('searchForm').style.display = \"block\";\r\n//        });\r\n//\r\n//    var searchResultSets =\r\n//        searchFormOpens.\r\n//            map(function() {\r\n//                var closeClicks = Observable.fromEvent(document.getElementById(\"closeButton\"), 'click');\r\n//                var searchFormCloses =\r\n//                    closeClicks.doAction(function() {\r\n//                        document.getElementById('searchForm').style.display = \"none\";\r\n//                    });\r\n//                return keypresses.\r\n//                    throttle(20).\r\n//                    map(function(key) {\r\n//                        return textbox.value;\r\n//                    }).\r\n//                    distinctUntilChanged().\r\n//                    map(function(search){\r\n//\r\n//                        return getWikipediaSearchResults(search).retry(3);\r\n//                    }).switchLatest().\r\n//                    takeUntil(searchFormCloses)\r\n//            }).switchLatest();\r\n//\r\n//    searchResultSets.forEach(\r\n//        function(resultSet) {\r\n//            results.value = JSON.stringify(resultSet);\r\n//            console.log(resultSet);\r\n//        },\r\n//        function(error){\r\n//            console.log(error);\r\n//        });\r\n//\r\n//    getWikipediaSearchResults('France').forEach(function(results){console.log(results); });\r\n//\r\n//\r\n//}"]}